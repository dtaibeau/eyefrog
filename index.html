<!doctype html>
<meta charset="utf-8" />
<title>eyefrog — movable tongue target + 4 locked shots</title>
<style>
  html,body{height:100%}
  body{
    margin:0; background:#000; color:#7CFF8B;
    display:flex; align-items:center; justify-content:center;
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
  }
  .stage{position:relative; width:100vw; height:100vh; overflow:hidden}
  pre{
    margin:0; white-space:pre; tab-size:2;
    line-height:1; letter-spacing:0; font-size:16px; /* character cell size */
    transform-origin: top left; position:absolute; top:0; left:0; user-select:none;
  }
  #base   { color:#19f06d; text-shadow:0 0 6px #093; }
  #overlay{ color:#b7ffcf; text-shadow:0 0 10px #0f5; }
  #hud{
    position:fixed; left:10px; bottom:10px; right:10px;
    font:12px/1.35 ui-monospace,monospace; color:#9fe9b3; opacity:.85
  }
  kbd{padding:1px 4px;border:1px solid #366;border-radius:4px}
</style>

<div class="stage">
  <pre id="base"></pre>
  <pre id="overlay"></pre>
</div>
<div id="hud">
  <div>
    <b>Move Tongue Target (crosshair)</b>: <kbd>I</kbd>/<kbd>K</kbd> up/down, <kbd>J</kbd>/<kbd>L</kbd> left/right (hold for faster).<br>
    <b>Save into slot</b>: <kbd>1</kbd>=NOTHING, <kbd>2</kbd>=TO, <kbd>3</kbd>=SEE, <kbd>4</kbd>=HERE. &nbsp;
    <b>Lock/Unlock targets</b>: <kbd>T</kbd>. &nbsp; <b>Log current tip</b>: <kbd>K</kbd> (while extending).<br>
    <b>Show/Hide crosshair+labels</b>: <kbd>G</kbd>. &nbsp; <b>Pause</b>: <kbd>P</kbd>. &nbsp; <b>Speed</b>: <kbd>+</kbd>/<kbd>-</kbd>.
  </div>
</div>

<script>
/* ===== 1) PASTE YOUR BIG ASCII HERE ===== */
const ART = `
                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                            .  .                                                                                                                                                                                
                                                                                                                                                                                                                       ... . .  . . .                                                                                                                                                                           
                                                                                                                                                                                                                    ...   .   .  . . . . .                                                                                                                                                                      
                                                                                                                                                                                                                 ...  . .     . ......... . .                                                                                                                                                                   
                                                                                                                                                                                                              .:... .. .... .... ............ .                                                                                                                                                                 
                                                                                                                                                                                                            ::.............:::::::..............                                                                                                                                                                
                                                                                                                                                                                                          .::......::::;;+++x+++++++++;:.........                                                                                                                                                               
                                                                                                                                                                                                         :::.....:;++++xxxx+;:........:;;;::.......                                                                                   ..:.                                                                      
                                                                                                                                                                                                        ;::....::+++xxxXx+;::..          ..:::......                                                                              ..::;;;;;:                                                                    
                                                                                                                                                                                                       ;::...::;+xxxxx+;::...               .:::.....                                                                         ..:::::;;;;;;;:                                                                   
                                                                                                                      ....:::::::::..                                                                 :;::..:;;++xxx+;:.. .                  .:;:....                                                                      ...:::::;;;::;;;;;:                                                                  
                                                                                                                  ::.... .    . . ...:..                                                              ;::.::;;+xxxX+;:..                       :;:....                                                                  ....::::;;;;;;;;;;+++;                                                                  
                                                                                                               .:.....      .        ......                                                          :;::.:;;++xxx+;:..  .::.                   :;:..:.                                                               . ..:::::;;;;;;+;++;++x+                                                                  
                                                                                                              :...   .       . .. . . .. .....                                                       ;;::::;++xxxx;:.. :$&&&X:    :.             :;:.::                                                              . . ...::;++++++x+xx++xx+                                                                  
                                                                                                            ........  ................ .........                                                     ;:::::;+xxxx+;:.:$&&&&&&x  ;$&&$.            ::..::                                                          .::::::;;;+++++xxXXXXXXXXX+                                                                   
                                                                                                          ...... . ...............................                                                   ;::::;;+xxxx+:.:$&&&&&&&&&&&&&&&$.           .:::::.                                                       ..::;;;;;++++xxXxXXXXXXXX+:                                                                     
                                                                                                         ..............::::::::::..................                                         .........::.:::;+xx+x+:.+&&&&&&&&&&&&&&&&&+            ::::;;                                                     ...::::::::::                                                                                     
                                                                                                       ..........::::::;;;;;;;;;;;;;::...............                              ........................::;+++;:.x&&&&&&&&&&&&&&&&&X            :;:.;+                   ...                         . . ....:::::::                                                                                         
                                                                                                      .........:::::;;;;+++x+++++++++++::.............                       ....:.............................::::.+&&&&&&&&&&&&&&&&&$:           :;::;x.                .:..             . . . . . ..::::::::::::::;.                                                                                         
                                                                                                    .........::::;;+xxx++;:......:::;;++++:............                 ...:::.............. .... ..................:+$&&&&&&&&&&&&&&&$:      . .  ::::;X;             ..:....        . .. .... . . ....:..:::::::;;;.                                                                                          
                                                                                                   ........::;;++XXx+;..            ..:;++++;...........            .::::::...... .  . .   . .  . . ...................:;X&&&&&&&&&&&&$;::.....:.  :;::+X;          ..::.....       . ..... .      . . ...::::::::.                                                                                             
                                                                                                  ........;+++XXx+;                    ..:;+++:..........       .::::::::..... . . .             . . . . ..............::::;+$&&&&&&&&&+;::::.::...::::+$+       ..............                     ....                                                                                                        
                                                                                                .........;++XXx+;.            ;X.        ..:;+++:............::::::::::::..... . .  .     .  . . . ......................::::::;X&&&&&$+;::::::::::;:::x&+  ...................                                                                                                                                 
                                                                                               .:.......;+xXX+;.            :&&&&X     .X$:..;+++::........:::;;:;:::::..... ..   .   . .  . ...... .    .  ...............:::::::X&&&X+;;;;::::::::::;X&;......................    . . .                                                                                                                       
                                                                                               :.......;+xXx+:.            +&&&&&&&.   $&&&; .:;++;:.......:;;;;;;:::::...... . .  . . . .. .               .................:::::;x$Xx++;;;;;:::;;:::+&&:.......................      . ....                                                                                                                   
                                                                                              ::......;+xXx+;.            X&&&&&&&&&::&&&&&&+ .:;++::.:::...:;;;;;;::::......... . . . .              .. .     .............:.::::::;xx+++++;::;;;:::+$&X.......................... . . . .......                                                                                                               
                                                                                             ::.......++XX+:.           ;&&&&&&&&&&&&&&&&&&&&; .:+++:.:::::.:;;;;;::::::...... . .                . .. .......  ................::::::+x+++;:;;;;:::+$&&. .  . .................................::.. .  .                                                                                                       
                                                                                             ::......:+xXx;...         :$&&&&&&&&&&&&&&&&&&&&&; .:++;::::::.:;;;;;;::::::....... .                 . . . . ......................::::::;+++;;+;::;;x$&&;     ... ................::;;;;;::::........:... .....                                                                                                  
                                                                                            .::......;+XX+:::.         ;&&&&&&&&&&&&&&&&&&&&&&&;..;xx:::::::.:;;;;::::::...... . .                   ........... .. ..............:::::::;;:::;+XX$&&&X        ................::;;+++++++++;;;::::.....:.......... .          .                  .:::::.                                                       
                                                                                            .::......;+XX+::.          X&&&&&&&&&&&&&&&&&&&&&&&&:.:+X;;;::::::;;;;::::::.........                               . .. ...............:::::;+xX$$$$&&&&x       . ...............:;;+++++x+x+x+++++++;;;::::::::::::::::...... .   . . . .  ..::;;;;;;;;;++++++:                                                   
                                                                                            .::....::+xXX;::           $&&&&&&&&&&&&&&&&&&&&&&&&X.:;x+;;::::::;;;::::::....... .                              . .  . . ..............:::::;+X$&&&&&$:.   . .  .............::::;++++++++++++++x+++++++++;;::::::;;;;;;;::::::.. . .......::::;;;;::;;+++++++xx                                                  
                                                                                             ::....::+xXX;:.   .      .$&&&&&&&&&&&&&&&&&&&&&&&&$..;++;;::::::;;::::::........  . .                       . .. . .. . . . .............:::::;x&&&+..... . . . . . ........:::..;++;.                 .::;++++;;;;;;;;;;;;;;;;;;;::. . .....::;;;+++++++xx++++x+                                                 
                                                                                             ::....::+xXx;:.  ..  .   .+&&&&&&&&&&&&&&&&&&&&&&&&$..:;+;;:::::;;::::::....... .. .                     . ...................................:::;x+..... .. .       . ......:::..:.                               :;;;+;;;;;;;;;;;;;;;;;::::..::::;;;++++++x+++++                                                 
                                                                                             ::....:;+xXx;. . ........ :X&&&&&&&&&&&&&&&&&&&&&&&;..:;++;:::::;:::::::........ .                    ........::::::::::::::::::::...............:::::....... .         .....:::..                                         ::;++++++++++++++;;;;;;;;;;++++++x++xx+:                                                
                                                                                             .::...:;+xXX;:. .:....:....;$&&&&&&&&&&&&&&&&&&&&&X...:;++;:::::::::::....... .                   ...............::::::;;;;;;;;;;;;:::::...........::::........            ...:::.                                                 .:;+++++++++++;;;;;++++++xx+xx+;                                                
                                                                                             .:::..:;+xXX;:..::::::::::..:$&&&&&&&&&&&&&&&&&&&X:...:;++;::;::::::::..... .                  .   .......:::;+xXX$$$$$&&$&$$$$$$$$XXx++;;:::........:::...... .             ..::.                                                        :+++++++++;+++++++xx+xx+;                                                
                                                                                              ;::...;++XX+:::::::::::::...;X&&&&&&&&&&&&&&&&&+:....:+++;:::::::::...... .                  . ....::;+XX$&&&&&&&&&&&&&&&&&&&&&&&&&&&&&$$XXX+;::......::.......              ...:.                                                           :;++++++++++++++xxx+                                                 
                                                                                              :;:...:++XX+:::::::::::::::..:;x$&&&&&&&&&&&X;:.....:;++;;:;:::::.......    . . .         ....::;+XX$&&&&&&&&&&&&&$$XxxxxXXXX$$&&&&&&&&&&&&&&&$X+::....:++....     .          ...::                                                             :;++++++++++++;                                                   
                                                                                               ;;:...;+xXX+:::::::::::::::..::::;++xxx++++::.....::;++;:;;::::............         ....:::;+X$&&&&&&$X+;:::::::::::;;;;;+++++++xXXXXXX$&&&&&&&&&$+:...;&$:.... .. ..          ...:.                                                                 ...                                                         
                                                                                               :;::..:+xX$X+::::::::::::::::::::::::;;;;;;:.....::;;++;;;::::......... . .     .....::;;+X$&&&$x+;:::::::::::;;;;;;;;;++++++xXXXXXXXXXXXXXXX$$&&&&&$X+$&&X:...........           ...                                                                                                                            
                                                                                                +;::..;+X$$X;::::::::::::::::::::::::::::::....:;;;++;;+;:::........ ..    ......:;;+X$$&&$+::.::::::::::;;;;;;;+++xxxXXXXXXXXXXXXXXXXXXXXXXXXXX$&&&&&&&$X+::::::........          ...                                                                                                                          
                                                                                                .+;::::+xX$XX+;:::::::::::::::::....::.:::...::;;+++;;+;:::...... . .  . ....::;+xX$&&&X;::::::::::;;;;;++++++xxxxxxxxxXxXXXXXXXXXXXXXX$X$XXXXXXX$$&&&&&XXx::::::::::........ .      ...                                                                                                                        
                                                                                                 :+;:;;;+xX$$x+;;::::::::::::::...    ......:;+;++;;;+;:::..... .. . ......:;+X$&&&$+::::::::::;;;+++++xxxxxxxxxxxxxXXXXXXXXXXXXXXXX$$$$$$$$$$$$$$$$$$XXXX+;;;xXXX+;;:::......... .     ...                                                                                                                     
                                                                                                  :+;;;;;+xXX$x+;;;:::::::::....     ....::;;;+++;;++::::.... . . ......:;+X$&&$X+:::::::;;;;++++++++x++xxxXXXXXXXXXX$X$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$XXXXx;+xXX;::;;;;;;::...........    ..:..                                                                                                                 
                                                                                                   .;;;+++++xXXX++;;;::::::..... .....:::;;+++++;;+;:::.... . .......::;xX&&$+;:::;;;;;;;+++++++++++xxXXXXXXXXXXXX$XXXXXXXXXXXXXXX$$$$$$$$$$$$$$$$$$$$$XXXx++xX+        .::;:::::........   .....:.:::::.:...                                                                                                   
                                                                                                     :;+++++;+xXXXx++;;::......:::::;;;;++++++;;+;::::............::;+X$&X+;:;;;;;;;++++++++++++xxXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX$XXX$$$$$$$$$$$$$$$$$$$XXX+++xX:              .::::.........   ...............                                                                                                  
                                                                                                       :;+++++++++xXXx+++;;;;;;;;;;;;;;;;;;;;++;;:::...........::;x$$$X+;;;;;;++++++++x+x+++xxxXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX$$$$$$$$$$$$$$$$$$$$$XXX+++xX                    ..:.......... .........::..                                                                                                  
                                                                                                        +x++++++++++++++xx+++++++;;::;;;;;+;;;;;:..........::;+X$&$x;;;;;;+++++xxxxxxxxxxxxxXxXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX$$$$$$$$$$$$$$$$$$$$$$$$XXXXx++x+                        .:.................::::.                                                                                                 
                                                                                                       :$&$$X+++++++++++;+;+;+;;;;;;;;;;;;;;::.........:;;+X&&&$x;;;;++++++xxxxxXxXXXXxXxXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX$XX$$$$$$$$$$$$$$$$$$$$$$$$$XXX$+;;x+                           .:...........:..::::.                                                                                                 
                                                                                                       X$&&&&$$$XXxx++++++++++++++++++++;::.........::+x$&&&X+;;;;;+++++xxxxxXxXxXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX$X$$$$$$$$$$$$$$$$$$$$$$$$XX$X;;++;                             .:.........::::::;:                                                                                                 
                                                                                                      +$&&$$$$$$$$$$$$$$$$$$$XXXx++;;:::..........:;+$&&&$++;;;;++++x+xxxxxxxxXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX$XXXXXXXX$$X$$$$$$$$$$$$$$$$X$$+::;+;                               ..........::::::.                                                                                                 
                                                                                                     .X$&$$$$$$XXXXXXXXXXxx+++;;:::..............;X$&&&X+;;;;;++++xxxxxxxxxXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX$$$$$$$$$$$$$$$$$$X$$X;::;;;.                                ........::::::                                                                                                  
                                                                                                     +X$$$$XXXx+;;;;;;;;::::::.................;X$&&&x+;;;;++++xxxxxxxxxxXxXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX$$$$$$$$$$$$$$$$$X$$+;:::;;:                                 ........:....                                                                                                  
                                                                                                     XX$XxxXx+++++;;::::::::.................+$&&&&X;;;;;+++xxxxXXXxXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX$$$$$$$$$$$$$$$$$$$X;::::;++                                   .........                                                                                                    
                                                                                                    :X$$xxxx+++++;;::::::.:...............:x$&&&&X;;;;;+++xxxxXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX$$$$$$$$$$$$$$$$$$$$$$$$$$$$$X+:::::;;x+                                                                                                                                               
                                                                                                    ;X$X+++++++;;::::::.:................x$&&&&$+;;;;++xxxXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX$$$$$$$$$$$$$$$$$$$$$$$X;::.:::;+x:                                                                                                                                              
                                                                                                    ;XX+++++++;;:::::.:...............:+&&&&&$+;;;;++xxxXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX$$$$$$$$$$$$$$$$$$$x.;:::..::;++X                                                                                                                                              
                                                                                                    ;Xx+++++++;:::::.................+$&&&&&x;;;+++xxxXXXXXXXXXXXXXXXXXxXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX$$$$$$$$$$$$$$$&X   ::::..:;;+xx                                                                                                                                             
                                                                                                    ;Xx++++++;;::::................+$&&&&&X;;++++xxXXxXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX$$$$$$$X$$$$$$$$;   ::::...:;;++x                                                                                                                                            
                                                                                                    :Xx+++++++;;;:...............+&&&&&&X+;;;++xxXxxXXXXXXXXXXXXXXXXxXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX$$$$XXX$$$$$$&x     ::.....::;;+X:                                                                                                                                          
                                                                                                     Xx++++;x$x+;:............:+&&&&&&X+;++++xxxxxxXXXXXXXXXXXXXXxXXXxXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX$$XXXXX$$$$$$X      .:...::::::;;x+                                                                                                                                         
                                                                                                     +++++;+&&&$x;:.........;X&&&&&&$;;;+++++xxxxXXXXXXXXXXXXXxXXXxXxXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXxxXXXXXXXXXXXXXXXXXXXXX$XXxxXXX$$$$$        ::.:::::::;;;+x:                                                                                                                                       
                                                                                                     :x+++;+&&&&&&$X;::;X&&&&&&&&&X;;;;+++++++xxXXXXXXXXXXXxxXxXXxXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXxXxxxXXXXXXXXXXXXXXXxXxXXXXXxxxXXXX$X$$;         :..:::::::;;;;x+                                                                                                                                      
                                                                                                      +++;;;$&&&&&&&&&&&&&&&&&&$x;;;;;+++++xxxXXXXXXXXXXXXxXxxXxXXxXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXxxxxxxXxxXXXXXXXXXXXxxxxxxxXXXxxxXXXXXX$$+           ...::::::::;;;+;                                                                                                                                     
                                                                                                      ;++;;:+&&&&&&&&&&&&&&&$x;;;;+;++++++xxXXXXXXXXXXxXxXxxxxXXxXXXXxXXXXXXXXXXXXXXXXXXXXXXXXXXXXXxxxxxxxXxxxXxXXXxXXXxxxxxxxxxxxxxxxxXXXXXX$x              ..::;::::::;;+                                                                                                                                     
                                                                                                     .:+Xx+;:+&&&&&&&&&&&$x++++++++++++++xXXXXXXXXXXxXXxXxxXxXxXXXXxXXXXXXXXXXXXXXXXXXXXXXXXXXxxXxxxxxxxxxxxXxxxxxxxxxxxx+++xxxx+x+xxxXXXXX$$x                 .::;;:::::;;:                                                                                                                                    
                                                                                                   ....:+xXx++x$&&&&$X+++++++++++++++++xxXXXXXXXXXxXxXxXxxxXxXXXXxXXXXXXXXXXXXXXXXXXXXXXXXXXxXxxxxxxxxxxxxxxxxxxxxxxxxx+++++++++xx+xxXXXXX$$X                    .:;;;:::;;:                                                                                                                                    
                                                                                                 ......;++++xxxx++++++++++xxxx++++++++xxXXXXXXXXXxXxXxxxxxXxxxXXxXXXXXXXXXXXXXXXXXXXXXXXXXxXxxxx+xxxxxxxxxxxxxxxxxx++++++++++++++xxxXXXX$$$$.                        ::..:                                                                                                                                      
                                                                                                ......:::;;;;;;;;;;+++xxxxxxXXx+xxx++xXXXXXXXXXxXxXxxxxxXxxxXXXXXXXXXXXXXXXXXXXXXXXXXXXxxxxxx+++xxxxxxxxxxxxxxx+++++++++++++++xxxxxXXX$$$$$:                                                                                                                                                                    
                                                                                              ........::::::;+++xxxxXxxxxxxXXXxxxxXxxxXXXXXXXxxXxXxxxxxxxxxXXXXXXXXXXXXXXXXXXXXXXXXxxxxxx+++++xxxxxxxx++x++++++++++++++++++x++xxxXXX$$$$$$;                                                                                                                                                                     
                                                                                            ............:::::;;;++++++++xxXXXXxxXXXXXxXXXXXXxXXxxxxXxxxxxxXXXXXXXXXXXXXXXXXXXXXXXXxxxxx+++++++++++++++++++++++++++++++++++x+xxxXXXX$$$$$$+                                                                                                                                                                      
                                                                                           .............::::::;;;;;++++xxXX$XXXXXXXXXxXXXXXXXXXXXxxxxxxxxXXXXXXXXXXXXXXXXXXXXXXxxxx++++++++++++++++++++++++++++++++++++xxxxxxXXXX$$$$$$$X                                                                                                                                                                       
                                                                                         ...............::::;;;;;;++xxxXXX$$$XXXXXXXXXXXXXXXXXXXxxxxxxxXxXxXXXXXXXXXXXXXXXXXxxxxxxxx+++++++++++++++++++++++++++++++++xxxxXXXX$$$$$$$$$$X                                                                                                                                                                        
                                                                                       ...............:.::;;;;;;+++XXXXXX$$$$$$X$$XXXXXXXXXXXXXxxxx+xxxxXXXXXXXXXXXXXXXXXXxxxxxxx++++++++++++++++++++++++++++++++xxxxXXXXXX$$$$$$$$$$$$.                                                                                                                                                                        
                                                                                     ................:::;;;;;;;++xXXX$XX$$$$$$$$$$XXXXXXXXXXXXxxxxxxxxxxXxXXXXXXXXXXXXXxxxxxxxx+++++++++++++++++++++++++++++++xxxXXXXXXX$$$$$$$$$$$$$$;                                                                                                                                                                         
                                                                                    .................::;;;;;+;;++xX$$$$$$$$$$$$$$$$XXXXXXXXXXxxxxxxxxxxxXXXXXXXXXXXXxxxxxxxx+++++++++++++++++++++++++++++++++XXXXXXXX$$$$$$$$$$$$$$$$+                                                                                                                                                                          
                                                                                  ...................:;;;;;;;++++xXX$$$$$$$$$$$$$$$$XXXXXXXXxxxxxxxxxxXxXxXXXXXXXXxxxxxx+x+++++++++++++++++++++++++++++++++xxXXXXXXXXX$$$$$$$X$$$$$$x                                                                                                                                                                           
                                                                                .:::................:;;;;;;;++++xxX$$&$$&&&$$$$$$$$$$XXXXXXxxxxxxxxxxxXXXXXXXXXXxxxxx+x+x+++++++++++++;+++++;+++++++++++++xXXXXXXXXX$X$X$$$$XX$$$$$X                                                                                                                                                                            
                                                                              ..:::::...............::;;;;+;++++xxXX$$$$&&$$&&&&$$$$$XXXXXxxxxxxxxxXXXXXXXXXXXXxxxx+xxx++++++++;;;;;;;;+++;+++++++++++++xXXXXXXXXXXXXXXX$$$XX$$$$$$:                                                                                                                                                                            
                                                                             ..:::.:...............:::;;;+;;;;+++xXXXX$$&$$$$&&&&$$$$XXXxxxxxxXXXXXXXXXXXXXXXXxxxxxxx+++++++;;;;;;;;;;;;;+++++++++++++xXXXXXXXXXXXXXXXXX$$XXX$$$$$;                                                                                                                                                                             
                                                                           .....::.................:::;:;+;;;+;+++++xX$$$$$&&&&&&&$$$XXXXXxxxxXXX$XXXXXXXXXXxxxxxxxx++++++;+++;;;;;;;;;;;+++++++++++xxxxXXXXXXXXXXXXXXX$XXXX$$$$&+                                                                                                                                                                              
                                                                          ....:.:...................::;:;;;;;;+;++++XX$$$X$&&&&&&&$$$$XXXXXxxxXXX$XXXXXXXXXXxxxxxx++++++;++++;;;;;;;;;;;;;;+++++++xxxxxXxXXXXXXXXXXXXXX$XXXX$$$&x                                                                                                                                                                               
                                                                        .....:......:::::.........:.:::::;;:;:;;;;++XX$$XX$&&&&&&&&$$$XXXXXxxXXXXX$XXXXXXXXxXXXXx+++++++++++;;;;;;;;;;;;;;;;+++++++xxXXxXXXXXXXXXXXXXXXXXX$$$$&$                                                                                                                                                                                
                                                                       ..:.:::....:::::.............:::::::::::::;;+xXXXXX$&&&&&&&&&&$$$XXXxXXXXXXXXXXXXXXXXXXxx++++++++++;;;;;;;;;;;;;;;;;+++++++xxxXXXXXXXXXXXXXXXXXXXXX$$$$$                                                                                                                                                                                 
                                                                      ....:......::::...........:...::::::::::::::;;;+xxxXX$&&&&&&&&&$$$$XXXXXXXXXXXXXXXXXXXXxx++++++++;+;;;;;;;;;;;;;;;;;;+;++++xxxXXXXXXXXXXXXXXXXXXXXX$$$$$:                                                                                                                                                                                 
                                                                    ...:::.........................::::::::::::::::;;;++xxXX$&&&&&&&&$$$$XXXXXXXXXXXXXXXXXXXxx+++++++;;;;;;;;;;;;;;;;;;;;;;+++++xxxXXXXXXXXXXXXXXXXXXXX$$$$$$;                                                                                                                                                                                  
                                                                   ..:::...........:::::::....:.:..::::::::::::::::::;;;+xXXX$&&&&&&&&&$$$$XXXXXXXXXXXXXXXXxxx++++++++;;;;;::::::;;;;;;;;;+++++++xXXXXXXXXXXxxXXXXX$$XX$$$$$x                                                                                                                                                                                   
                                                                  .:::............::;:::.....:.:.:::::::::::::::::::::;;;+xXX$$&&&&&&&&&$$$XXXXXXxXXXXXXXXxxxxx++++++;;:::. ....:::;;;;;;;++++++xxXXXXxXXXXxXXXXX$$$$X$$$$$X                                                                                                                                                                                    
                                                                 .::::.:......:...:::::.:.:.:.::::::::::::::::::::::::::;;+xXX$$$&&&&&&&$$$XXXXXXxxXxXXXxxx+++x++;;:::.. .    . .::;;:;;;;+++++xxXxXxXXXXxxXXXXX$$$$$$$$$$X                                                                                                                                                                                     
                                                                .:::........::::....:.:..:.::::::::::::::::::::::::::::::;++xXX$$&&&&&&&$$$XXXXXx+;;+++++;++++++++;:. .        ...::::;;;++++++xxxxxxXXXXXXXXXX$$$$$$$$$$$:                                                                                                                                                                                     
                                                               .:::.:......::::.::::::.:::::::..::::::::::::::::::::::.:::;++xxX$$&&&&&&&$$$XXXx+;:..:::;;;;;++;;:;;:.       .  ..::::;;;+++++xxxxxXXXXxXXXXX$$$$$$$$$$$$;                                                                                                                                                                                      
                                                              .:::::........:.::.:.:.:::::::::.::::::::.:::::::::::::....::;++xX$$$&&&&&$$$XXx++:      ..:...::      ..       . .::::;;;;++++xxxxxxXXxXXXXXX$$$$$$$$$$$$+                                                                                                                                                                                       
                                                             .:::::.........::::::.:.::::::::.:.:.::::.::::::::::::::......:;++xXX$&&&&&$$Xx+++;:..                            ..:::;;;;+++++xxxxXXXXXXXXXX$$$$$$$$$$$$X                                                                                                                                                                                        
                                                            .:::::.:.:....:.::.:.:::::::::::..:.:.:.:.:.::::::::::::.......:;+++xXX$&&&$$Xx+++:...                             ..:::::;;++++x+xxXXXXXXXXX$$$$$$$$$$$$$$                                                                                                                                                                                         
                                                            :::....::::.:.:::::.:.::::::::..:.:.:.:.:.:::::::::::::.........:;+++xX$$$$$Xxxx;.....                              .:::::;;+++++xxXXXXXXXX$$$$$$$$$$$$$$$:                                                                                                                                                                                         
                                                           :::..:.:::::.:::::.::.:::::::::::::.:.:.:..:.:::::::::::..........:;+;+X$$$$XXx+;.......                            .....:;;+++xxxXXXXXXXXX$$$$$$$$$$$$$$$;                                                                                                                                                                                          
                                                          .::....:.::::::::.::.::::::::.:::::::.:.:..:.::::.::::::............;++;+X$$Xx+;::......                               ..::;+++xXXXXXXX$XX$$$$$$$$$$$$$$&$+                                                                                                                                                                                           
                                                          :...:.:.:.::::::.:.:::::::::.:.::.:.:.:.:.:.::::::::::::............:+;;x$Xx++;:........                             ....:;+++xXXXXXX$XXX$$$$$$$$$$$$$&&$X                                                                                                                                                                                            
                                                         ..:...:.::::::::.:::::::::::.:::.::.:.:::..:.::::.:::::::............:;++Xx+++;:..........                             ..:;+++xXXXXXX$XXXX$$$$$$$$$$$&&&$$                                                                                                                                                                                             
                                                         .:.:.:::.::;;:::::::::::::.::.:.:.::.:.:.:.:::::.:::::::.............:;++++++;:......... ..                          ...:;;++xxXXXXXXXXXX$$$$$$$$$&&&&&&$:                                                                                                                                                                                             
                                                         ..:.::::::;;;::::::::::::::.::.:.:.::.:.:.:.::::.:::::.:........... ..;+++++;............ ...                       ....:;;++xXXXXXXXXXXX$$$$$$$$&&&&&&&;                                                                                                                                                                                              
                                                        .::.:::::::;+;::::::.::::::::.::.::.:.:::..::.::..::::.:.:........... .:;+++;......... . . . .                     . ...:;;++++xxXXXXXXXX$XXX$$$&&&&&&&&X                                                                                                                                                                                               
                                                        .:.:::::::::;:::::::::::::.::::.:.:.::.:.:.::::..::::.:.:..........  . .;++;........ . . . . .                    . ..::;;;++++xxXxxxxXX$XXX$$&&&&&&&&&$                                                                                                                                                                                                
                                                       .::::::::::::::::::::.:.:.::::.::::.:.:..:.:..:...:::.:.:...........  ..:;+;........... . . .. .                  . ..::;;;+++++xXxxxxXX$XXX$$$&&&&&&&&&.                                                                                                                                                                                                
                                                       ::::::::::::::::::.:::.:.:::.:::.:.:.:.:.:.::::..:::...............  . :+x;.......... . . .. .. .      ..        . ...:;;;;++++xxxxxxxXXXXX$$&&&&&&&&&&;                                                                                                                                                                                                 
                                                      .::::::;;::::::::.:::::.:::::::.:.:.:...:.:...:...::...............    :+x;:.......... . .... ..       ..       . ....:;;;;++++xxxxxxxXXXX$$$$&&&&&&&&&+                                                                                                                                                                                                  
                                                      .:::::;;;:::::::::::::::::::::::.:::.::.:....:...::............. ..  . ;++:............ . .. ............     . .....:;;;;;++++xxxxxxXXXX$$$$&&&&&&&&&X                                                                                                                                                                                                   
                                                      :::::::;:::::::::::::.:::::;;::.:.:...:.......:..:................    .+x;:.......... . .. ..... .........  . .. ...:;;;;;;+++xxxxxxXXXX$$$$&&&&&&&&&$                                                                                                                                                                                                    
                                                     ::::::::::::::::::::::::::::;::.:.:.:.:......................... .    .;++;............... . .......... .... .......:;;;+;++++xxxxxxXXXX$$$$&&&&&&&&&&.                                                                                                                                                                                                    
                                                     ::::::::::::::;+::::::::::::::.:.:...:......................... .      ++;:.......... . ... .............. ... ...::;;+++;+++xxxxxxxXXXX$$$$&&&&&&&&&;                                                           . ...:.                                   .::;:.                                                                                          
                                                    .::::::::::::::;;::::::::::::.::.:.:.:.........................        :x+;........... . .. .......... ..........::;++++++++++xxxxxxXXXX$$$&&&&&&&&&&x                                                          ...:::::;:                               ..:::::;;;:                                                                                        
                                                    :::::::::::::::::::::::::::::...:............................. .       :x+;........ .. . .... .................:::;+++++++++xxxxxxxXXXX$$$$&&&&&&&&&X                                                .. .    .......:::;;;:                             . .::::::;;;;:                                                                                      
                                                   .:::::::::::::::::::::::::::::.:.:.............................         :++:............ ............. .......:::;;++++++++++xxxxxxXXXX$$$$&&&&&&&&&$                                               . .    ........::::::;++:                          ....::::;;;+++++;                                                                                     
                                                   ::::::::::::::::::::::::::::.:.............................. .          :+;......... ... ... ...............:::;;++++++++++xxxxxxxxXXX$$$&&&&&&&&&&&.                                            . .    .. ....:::;;;;;;;;+++.                       .. ..::::;+;;;;+++++                                                                                    
                                                   :::::::::::::::::::::::::::::...:......................... . .          :+;............. ........... . .:..:;;;;++++++++++++xxxxxxxXX$$$$&&&&&&&&&&;                                            . .  . . ..::;;;+++++++++xx++                     ..::..::::::;;;;;;;+++++                                                                                   
                                                  .:::::::::::::::::::::::::::...:.:....................... .. . .         :+:............ ............. .::::;;+;++++x+++++x+x+xxxxxXXX$$$&&&&&&&&&&+                                          . . .  . ...::::.::;;;;;++++;                    ....::::::::::::;;;;;++++x++:                                                                                  
                                                  :::::::::::::::::::::::::::.::.:.:..................... .. . .            ;:..............:......... ...::;;+++++++x+++++xxxx++xxxxXX$$$$&&&&&&&&&X                                              . .  . .:.                              ........::::::::::;::::;;;;++xxxX+;                                                                                  
                                                 .::::::::::::::::::::::::::::.:::.....................  .   .  .           .:........... ..:....... .. ..:;;+++++++x++++++x+x++xxxxXXXX$$&&&&&&&&&&          ......                          . .. .   ..:                            ..:.......::::::::;;;;;;;;;;;;;;+xxxxxx:                                                                                  
                                                 ::::::::::::::::::::::::::::.:::.:..:............... .     .                ..............::...... . . ..:;;++++++xx+++++x++++xxxxxXXXX$$&&&&&&&&&       .........                           .  .   . .                          .......:::::::;;;;;;;;;;;;;;;;;;+++;++++++;                                                                                   
                                                .:::::::;;;::::::::::::::::::::::..:............... .                       ..............:;;..... .   ....;;+++++xx++++x+++++xxxXxXXXX$$&&&&&&&&&;     ..........                          . . .  . .                         .......:::::;;;;+++++;;;;;;;;;;;;;;;;;;;+++;.                                                                                    
                                                .::::::;x+;:::::::::::::::::::::.:.:.............  .                        .............:;;;;..         ...;+++++++x+++++++xxxxXXXXX$$$$&&&&&&&&+     . . .......                          . . . . .                      ..:.....::::;;;+++xxx++;;;;;;;;;;;;;;;:;;;::.                                                                                        
                                                :::::::+Xx;:::;+;::::::::::::::.:.............. .          . .              .........:.::;+;;....          ..;++++++++++++xxxxxXXXX$$$$$&&&&&&&&X      . . .. . .                        . . .   .                     ..:......:::;;;+++xxXXx++;;;:                                                                                                            
                                               .::::::::;;;:::;;::::::::::::::.:.:............ .        . ..               .........::::;;;.....             .:++++++++++xxxxxXXXXX$$$$&&&&&&&&$       .. . .   .                           . .                     ..........::::;;+xxXXX+;:                                                                                                                   
                                               ::::::::::;;:::::::::::::::::.:.:........... .         .:::..            .  .........:.:;;;.......              .:++++++xxxxxXXXXXX$$$$&&&&&&&&&        ..       .                     .    . .. ..               .... .........::;xXXXX+:                                                                                                                       
                                              .::::::::::;;;;:::::::::::::::::.......... .. .       .:::::..  . .   .     .........:::;;;...... . .               .:;++++xxXXXXXXXX$$$&&&&&&&&;        ..       .                        . ......             .... .... ....::;+XXXX+.                                                                                                                          
                                              ::::::::::;;;;;;;;::::::::::::.......... . .       ..::;;:::. ...:..    . .  .......:.:;;:... . .. . .                 .:;+++++xxXXXXX$$&&&&&&&x         ..      .                        . .......         . .. . ...  ...:;;+xXX$x.                                                                                                                             
                                             .:::;:::::;;;;;;;;;:::::::::::..:::::... ..       ..:;;;::::...:::..  .      .........:;;... .. . . . . .. . . .           ..:;;+++xxXXX$$&&&&&X          ....     .                     . ..........    . . .. . .. ...:;;++xXXXX:                                                                                                                                
                                             .::;::::;;;;;;;;;;;;;;;;::::..::::::..... .     ..:;;;;:::::::::::...      .  ......:::....... . . .  . .        . .           ...:;;++xXX$&&&$            . .     .               .   . ............... .. . ......:;+++++xXXX;                                                                                                                                   
                                            .:::;:;::+Xx+;;;+;;;;;;::::.:::::::..... .     ..:;;;;::::::::::::::. . .    .......:........ . .. . .. . . .        . .            .....:;xXXX             ..      ..           ...  . .................. ........;+xXXxxXXXx                                                                                                                                      
                                            .:;;:::;;;++++++;;;;;;:::::::::;::.... .     ..:;;;;;::::::::::::::. .     .  .......:.:...... . ........... .          . . .   . .    . ......:.           . .     ..:.        ..   ................. . .......:;+xXXXXXXX;                                                                                                                                        
                                            ::;;:;;;++++++++;+;;;::::::::;;:..... .    ..:;;;;;::;;:;:::::::::..  . .   . .....:..:.::................... .. .    .    . .     ... . .  . ........      . .    ....::     ...  ............................;+xXXXXXXx.                                                                                                                                          
                                           .:;;;::;+++++++++++;;;:::::;;;:..... . .  .::;;;;;;;;;:;;:::::::::.. .     . . ......:..:.:....................... . .   .      .  .  . . ..... . . .......  .. .    ......   ... ............................;+XXXXXXX+                                                                                                                                             
                                           :;;;;:;;++++++++++++;;;;;;;;;.......    .:;;;+;;;;;;;:;:::::::::....  . .  .. . ...:..::::......:.:.:::::::............ . . .            .    . . . ......    .. . .  ... ...... ..........................:;+xxxxXXx;                                                                                                                                               
                                          .:;;;;;;;+++++++x+++;;;;;;;;...:...  ..:;;++++;;;;;;::::::::::::... . .    ... ......::::::.:.:::::::::::::::::.............. .. . . .      . . . . .            .        . ... . ...........:...........::;+++xXXXX+                                                                                                                                                 
                                          :;;;;;;;++++++++x+++++++;:..::::.::::;;+++++;;;;;;;:::::::::::....... ... . ........:::::::::::::::::::::::::................. . .... . . .    .  . . . .       . .     ...... ............:....:::...::;+++++xxxx+                                                                                                                                                   
                                         .;+;;;;;;++;+++++++++++;;:::::::;;++x+++++++;;;;;;:::::::::::............. ..:...:::..::::::::::::::::::::::::::::::.:.::.............. . . .... .. ..... .. . . . .    . . . . . . ......::.:::::::::;;++++++++++:                                                                                                                                                    
                                         :++;;;;;+++++++++x++++;;::::;++xxxxxxxxx++++;;;;;:::::::::::.............. ..:::::;;;:::::::::::::;:::::::::::::::::::::.:....:........................ .. .  . .    .. .. .   . .......::.::.::::::;;+++++++++++:                                                                                                                                                     
                                         ;++;;;;;+++++++++xxx++;;;+xxXxXxXxXXXXxx+++++;;::::::::::::....:....::::.. ...:::::;++;;;::::::::::;;;;::::::::::::::::::::::::::::........................ .. . .......... . . .......:.:::::::::::;++;;++;++++;                                                                                                                                                      
                                         ++;;;;;;;;;++++++xXxxxXXXXXXXXXXXXXXXxx++++++;;;;;:::::::::::::...::::::.. ..:::::::;++++++;::::::::::::;;;;;;;::::::::::::::::::........................... . . . ....:;:.  . .......:.::::::::::::;;;;;;+++++;:                                                                                                                                                      
                                         ++;:::;;;;;;++xxxXXXXXXXXXXXXXXXXXXxxxxxxx++;;;;;::::;:::::::::..::;:::::...:::;;;;;;+xxx++++;:::::::;;;;;;;;;;::::::::::::::::::::::........:........... . . ... .....;;. . . ......:::::::.:...:::;;;;;;;;;;;+;:                                                                                                                                                     
                                         ;+;::.::;;;;++xXXXXXXX$X$XXXXXXXXXxxxxxXXXx+++;;;;;;;:::;;;;::.:;;:::::::;:::;;++;++;;++xXXxxxx+;::::::;;;;;;;;;;;;;;;;:::::::::::::::::::::::::............... ......;+: . . .....::.::::::.....:.:;;:::::::;;;;;;:                                                                                                                                                   
                                         ;+;::...::;;++xXXXXXX$$$$XXXXXXXXXXXXXXXXxx++++;;;;;::;;;;;::::;;::::::;;:;;;;++++++++++++xXX$$$XXx+;;:::;;;;;;;;;+;;;;;;;;;;;;::::::::::::::::......................:x+.  . .......:::::..........:;; ....:::::;;;;;:                                                                                                                                                 
                                         :+;::::..::;+++xXXXXX$$$$$$XXXXXXXXXXXXXXx+++++;;;;;;;;;;;;;;;;;::::::;;;;;;;+++++++++++xxxxxX$$$$&&&$$x+;;;;;;;;;;+++++;;;;;;::::::::::::::::::.:::.............:...+x:  . ......:.::::::::........::      ..:::::;;;;;:                                                                                                                                              
                                          xx+;;::..:;;;+xXXXXX$$$$$X$$$$$$XXXXXXxxx++++++;;;;;;;;;;;;;;::::::;;;;::;;++++++++++++xxxxxXXX$$$$$&&&&&Xx+;;;;;;;++++++++;;;;;::::::::::::::::::.:..........:::..+X+  ........::::::::::::..........          .:::::::::.                                                                                                                                           
                                          ;Xx++;:::::;;+++xXX$$$$$$$$$$$$$XXXXXxxx+x++++++;;+++;;;;;;;;;;:;;;;;;;;+++++++++xx++++xxXXxXXX$$$$$&&&&&&&&&$x+;;;;;+++++++++;;;::::::::::::::::::.::...:..::::..+Xx. .........:::::::::::::.............            .::::::.                                                                                                                                        
                                           xXXx+;:::;;++xXXX$$$$$$$$$$$$$$XXXXXXXXxxxxxx++x++++;;++;;;;;+++++++;;+++++++++xXxxx++XXXXXXX$$$$$$&&&&&&&&&&&&$x++++++++++++++;;;;;;:::::::::::::::.:::::::::.:+$X+. .......:::::::::::::::...............              .::::::.                                                                                                                                    
                                            +XXXxxx++++xxXXXX$&$$$$$$$$X$X$XXXXXXXxxxxxxxx+++++++++;++++++++++;;++++++++xXXxxxxxXX$$$$X$$$$$&&&&&&&&&&&&&&&&&Xx+++++++++++++++++;;;;;:::::::::::::::::::::+X$X;........::::::::::::::::::......::;;;;;:::..           ..:.::::::.                                                                                                                               
                                             :XXXXXXXXXXxxxX$&&&&&$$$$$$$$$$$XXXXXXXXXxxxx+++++++;++++++xxxxx++++++x++xxxXxXXXXXX$$$$$$$$&&&&&&&&&&&&&&&&&&&&&&&X+++++++++++++++++;;;;;;;;;:::::;;;;;;::;xX$$+:......::::::::::::::;+++;....::;;;;+++++++;;;;;;:::... . .:::::::::::.........:::...::::                                                                                                         
                                                ;+xxxxxxx+++xXXX$$$$$$$$$$XXXXXXXXXXXXXXXxxx++++++++++xxxxxxXxxxXXXxxXxXXXXXXXXX$$$$$$&&&&&&&&&&&&&&&&&&&&&&&&&&&&&Xx+++++++++++++++++++++;;;;;;;;;;:::;+X$$X;..:::::::::::::::;;+++++++;;;;++xxxxxxxxxxxxxxxx++++++;;;;::::::::::::::::::::;;;:....:::                                                                                                         
                                                      ++++++++++++;;;;;;;;;;;:;;;;:;;;;+xXXXXXXXXxxx++++++++++xxxXXXXXXXXXXX$$$$$$$$$&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&$Xx+++++++++++++++++++++++;;;;;;;+xXXX+::::::;;;;;::::::;;;;;++++xXXXX$$$$&&&&&&&&&&&&&&$$$$XXxx++++++;;;;;::::::::;;;;;::...:;;:.                                                                                                        
                                                      +++++++++++++++;;;::::..............:;+X$$$$$XXXXXXxxxxxXXXX$$$$$$$$$$$$$$$$$$$&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&X+xx+++++++++++x+xxxxx+++++++++XX+;;::;;;;;;;;;;;;;;;;;;+++xXXX$$$&&&&&&&$$XXXXXXX$$$&&&&&&&$$$$XXXXxxx+++++;;;;;;+;;::::.::;;:                                                                                                        
                                                      ;+++++++++++;;;;:::::....................:+xX$$$&$$$$$$XXX$$$$$$$$$$$$$$$$$$&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&X        :;+++++++xxx++++++++++xX++;;;;++++;;;;;;;;;++++xXXXX$$$$$&$X+:                    :+X$&&&&$$$$$XXXxxx++++;;;;::::::;;+:                                                                                                        
                                                      ;++++x++++;;;;::::::::::.:..:................:+X$&&&&&&&&&&&$$$$$$$$$$$$$$$&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&X               .:++++++++++xxxXXx++++++++++++++++++++xxxxXXxx+:                                   :+$$&&&$$XXXXxx+;;;;::::;;;++;                                                                                                        
                                                      ;x+xxx+++++;;;:::::::::::.:..:.:...............:+X$&&&&&&&&&&&&&$$$$$$$$&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&+                       :;++xXX$$$XxxxxxxXxXxXxXXxxx++;:.                                                .+X$&$$$XXXx+;;;;:;;;;;+:                                                                                                        
                                                      :xxxxxxx++++;;;;:::::::.:.:.:.:.:.:.:.:..........:;+X&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&$                                   ....:...                                                                    :X$$XXx++;;;;:;;;;;                                                                                                         
                                                       xXXXxxxx+++++;;::::::::.:.:.:.:..:..:.:............:+X&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&$                                                                                                                    .x$Xx++++;;;;;;                                                                                                          
                                                        xXXXxXxxx++++;;::::::::::.:.:.:..:.:................:+$&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&$$$$&&&&&&+                                                                                                                         ;XXx+++;;;;.                                                                                                          
                                                         ;XXXXXXXXxx+++;;;;:::::::.:...:....:.:...............;x$&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&$$XXXXXXXX$&$.                                                                                                                             ;XXx++;;.                                                                                                           
                                                           +xxxxxxxxxxxxx+++;;:::::.::..:.::....:..............:;X&&&&&&&&&&&&&&&&&&&&&&&&&&&&XXXXXXXX$$$&$x                                                                                                                                    .:.                                                                                                             
                                                          .:;;;;;;++++++xxxx++;;:::::::::::::::..:.:......:......:+$&&&&&&&&&&&&&&&&&&&&&&&XXXxxXXXXX$X$$$$:                                                                                                                                                                                                                                                    
                                               ..::::::::::::::::::::;;;+++xxx++;;;:::::::::::::::.:::.....:.......;X&&&&&&&&&&&&&&&&&&&$XxxxxxxxxXXXXXX$X:                                                                                                                                                                                                                                                     
                                         ..:::::::::::::::::::::::::::::;;;++xxx+++;;;;;;::::::::::.:.:::.:.::......:+X$$$$&&&&&&&&&&&&X++++x++xxXXXXXXx:                                                                                                                                                                                                                                                       
                                      .::;;;;;;;;;;;;;;:;:;:::::::::::::::::;;+++++++;;;;;;;::::::::::::::::::::......;xXXXXXX$&&&&&&&x+x++++xxXXXXXX;                                                                                                                                                                                                                                                          
                                   .::;;::;;;::::::::::::::::::::::::::::::::::;;++x+++++;;;;;:::::::::::::::::::......:+XXXXXXX$&&&$++++++++xxXXXX:                                                                                                                                                                                                                                                            
                                  ::;::::::::::::::::::;;;;;;;;;:::::::::::::::::::;+xx++++;;;;;:::::::::::::::::::......;xXXXXXXX$X++++++++++XXX;                                                                                                                                                                                                                                                              
                                .:::::::.....::::::::;;;;;;;;;;;;;;::;;;;;:::::::::::;+xx+++;;;;;;;::::::::::::::::::. ...:xXXXxxXx+++++++++++Xx                                                                                                                                                                                                                                                                
                               .::::::.....:::::::;;;;;;:::::::;;;;;;;;;;;;;;;;::::::::;+xx++;;++;;;;;;:::::::::::::::.....:+XXX++++++++++;;+x+                                                                                                                                                                                                                                                                 
                              .:::::.....:.:::::::::::::::;;;;;;;;;;;;;;;;;;;;;;;;;++;;::;+xx+;;+++;;;++;;;::::::::::::.....:+XXx+++++++++;;x+                                                                                                                                                                                                                                                                  
                              ::::..:..:.::::::::::::;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;+++;;::+xx++;++++;+++;;:::::::::::::;:...:xxxxxx+++;+;;+X                                                                                                                                                                                                                                                                   
                             :::::::.:::::::::;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;++x++;::+xx++;++++;;+;;;:;;::::::::::;:..:+xxXXXx++++;;++                                                                                                                                                                                                                                                                   
                             ::;:::::::::::;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;+x++;;:;+x+++++++;;;;;;;;;:::::::::;;:.:+XXX$Xx+++;;;;;                                             .;++;                                                                                                                                                                                                                 
                            ;;;;;;:::::::;;;;;;;;;;;;;+;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;+xx+;;:;xx+;+++++;;;;;:;;;:::::;::;;:.:+XX$$Xx+++;;++;                                           :++++++++:                                                                                                                                                                                                              
                            ;;;;;;::;:::;;;;;;;;;;;;;+;;;++++;;;;;;;;;;;;;;;;;;;;;;;;;;;++xx+::+x++++++;;;;;;;;;;;;:;:;;;;;;::+$$$$Xx+++;;;+++:                                      :;++xxxxxxx+++                                                                                                                                                                                                             
                            +++++;;;;;;;;;;;;;;;;++++++++++++++;;;;+;;++++;;;;;;;;;;;;;;;;;+++;;+x+++++++;;;;;;;;;;;;;;;;;;;;;x$$&&$X++++;;;+++;                              :;++xxxxxxxxxxxxxx++++.                                                                                                                                                                                                           
                           :XXXx++++++++++++++++++++++++;+++++++++++++++++;;;;;;;;;;;;;;;;;;;+++;x++++++++;;;;;;;;;;;;;;;;;;;+X$&&&&X+++++;;;++++:                      :;+xxxxxxxxxxxxxxxx++++++++x+                                                                                                                                                                                                           
                           ;XXX$$Xx+++++++++++++++++++++++++++++++++++++;;;;;;;;;;;+;;;;;;;;;;;+++++++++++;;;;;;;;;;;;;;;;;;;xX$&&&&$xxxxx++;;;++++.               :+xxxxxxxxXXxxxxxxx++++++++++;;+++                                                                                                                                                                                                           
                           ;XXX$&$Xxxxxxxxxxx+x++++++++++++++++++++++++++++;;;;;;;;;++++;;;;;;;;;++;;+++++;;;;;;++;;;;;;;;+++X$$&&&&&$$XXxXxx++++++++;:     .:;+xxxxxxxxXXXXXXXXxxxxxxXXxxx+x+++++++:                                                                                                                                                                                                           
                           :X$$$$&$XXXxXXXxxxxx+x++++++++++++++++++++++++++++++++++++++++;+;;;;;;;;+;;+;;;;;;;;;+++;;;;;++++xX$&&&&&&&$$XXXXXxxxxxxxxxxxxxxXxXxxxxxxXXXXXXXXXXXXXXXXXXXXXXXxxx+++++:                                                                                                                                                                                                            
                            X$$$$&&$XXXXXXXXXxxxxxx+++++++x++++++++++++++++++++++++++++++++;;;;;;;;;;;;;;;;;;+++++++;;+++++XX$&&&&&&&&&$$XXxxxxxxXxxxXXxxxxxxxxxxXXXXXXXXXXxXXXXXXXXXXXXXxxx+++++.                                                                                                                                                                                                              
                            ;XXX$$&&$XXXXXXXXXXxxxxxxxxxxxxxxxx++xxxxxx++++++++++++++++++++++++++++;;;;;;;;;++++++;;+++++++X&&&&&&&&&&&$$XXXXXXXXXXXXxxxxxxxxXXXXXXXXXXXXXxxxxxxxxXxXXXXxxxxx++.                                                                                                                                                                                                                
                             +XXX$$&&&$$XXXXXXXXXxxxxxxxxxxXxxxXXXXxxx++x+++++++++++++++++++++++++++++;;;;+++++++++++++++xX&&&&&&&&&&&&&$$$XX$$XXXXXXxxxxXXXXXXXXXXXXXXXXx+;.                                                                                                                                                                                                                                   
                              xXXX$$&&&&$XXXXXXXXxxxxxxxXXXXXXXXXXXXXXXx++++++++++++++++++++++++++++;++++++++xxx+++++xxxX&&&&&&&&&&&&&&&$$$$$$$$$XXXXXXXXXXXXXXXXXXXXXXX:                                                                                                                                                                                                                                       
                               +XXXX$&&&&&$XXXXXXXxxXxxXXXXXXXXXXXXXXXxxxx+++++++++++++++++++x+++++++++++xxxXXXxxxxXXX$&&&&&&&&&&&&&&&$$$$$$$$$$XXXXXXXXXXXXXXXXXXXXXXx                                                                                                                                                                                                                                         
                                ;XXXXX$&&&&$XXXXXXXxxXXXXXXXXXX$$$$$$XXXXXxx+++++++++++++++xxxx+++++++xxxXXXXXXXXXX$&&&&&&&&&&&&&&&&&&&$$$$$$XXXXXXXXXXXXXXXXXXXXXXXXx.                                                                                                                                                                                                                                         
                                 .xXXXXX$&&&&$$XXXXXXXXXXXXX$$$$X$X$X$XXXXXXxxxx+++++++xxxxxXXXxxXXXXXXXXXXXXX$$&&&&&&&&&&&&&&&&&&&&&$$$XXXXXXXXXXXXXXXXXXXXXXXXXXxxx:                                                                                                                                                                                                                                          
                                   :xXX$$$$&&&&$$XXXXXXXXXXXXXXXX$X$XXXXX$$XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX$&&&&&&&&&&&&&&&&&&&&&$$XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXxx+                                                                                                                                                                                                                                           
                                     ;xXX$$$$$&&&&&$$XXXXXXXXXXXXXXXXXXX$$$$$$XXXXXXX$$XXXXXXXXXXX$$$$$XX$&&&&&&&&&&&&&&&&&&&&&&$$$XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXx;                                                                                                                                                                                                                                           
                                       :xX$$$$$&&&&&&&&&$$XXXXXXXXXXXX$XX$XXXX$XX$XXXX$$$$$$$$$$$$$$$&&&&&&&&&&&&&&&&&&&&&&&&&&$$XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX+                                                                                                                                                                                                                                           
                                          +X$$$$&&&&&&&&&&&&&&$$$$$XXX$$$XXXXXX$$$$$$$$$$$$$$$&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&$XXXxxxXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX;                                                                                                                                                                                                                                          
                                            :X$$$$&&&&&&&&&&&&&&&&&&&&&&&&&&&&&$&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&$XXx++xxXXXXXXXXxXxxxxXXXxxxXXXXXXXXXXXXXXXX;                               .:;+++;                                                                                                                                                                                                  
                                               ;X$$$&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&$$$XXx+++xXxxxxxxxxxxxxXxxxXxxXxxxxXXXXxxXXXXXXXXXX;.                     :++xx++++++++:                                                                                                                                                                                                
                                                  :x$$$&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&$$$$$$XXxx+++++++xxxxxxxxxxxxxxxxxxxxXxXxxxxxxxxxxxxXXXXXXXXXx+;:          .;++xxxxxxxx+x+xx++:                                                                                                                                                                                               
                                                     :XX$$$&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&$&$$$$$$$$$$$$$$$$$$XXXx++xx+++++xxxxxxxXXXXxxxxxx+x+xx+xxxxxxxxxxxxxx++++xxxxxxxxxxxxxxxxxxxx++++++xxxxxxx+++++++:                                                                                                                                                                                              
                                                         :+X$$$&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&$$$$$XXXXXXXxxxxxxxxxx++++;;++++xxxxXXXXX$$XXXxxxxxx+x+++++++xxxxxxxxxxxxxx+++++++++++++++++++++++++++xxxxxxxx++++++                                                                                                                                                                                              
                                                              :+X$$&&&&&&&&&&&&&&&&&&&&&&&$$$$$$$$$$XXXXXxxxxxxXx++++;;;;;;;+++xXXXXXX$$$$$$$$Xxx+++xxxxXXXXXXxxXxXXXXXXXXXXxXxXxxxxxxxxxxxxxxxxxxXXxxxxxxxxxxx+++:                                                                                                                                                                                             
                                                                    ;+X$&&&&&&&&&&&&&&&&$$$$$$$$$$$$$$XXXXXXXXX+++++;;;;;;;;++xxxxXXXXX$$$$$$$XXXXXXXXXXXXXXXXXXX$$$$$$$$$$$XXXXXXxxxxxxxxXX$$XX$$XXXXxxxxxxxxXXXx:                                                                                                                                                                                             
                                                                          :+X$&&&&&&&&&&&&&&$$$$$$$$$$$$$$$$XXXXx+++++++;;;;++xxXXXXX$X$$$$$$$$$$XXXXxXXXXXXXXXXXXXXXXXXXxxxxx+++xXX$$$$$$$$$$$$$$$$$XXXXXxxxXXXXx                                                                                                                                                                                              
                                                                                 ;x$$&&&&&&&&&&&&$$$$$$$$$$$$$XXXXXxxx++++++++++xXXXXXXXXXXXXxXxx+++++++++++++++++++xxxxxxxxxxxX$$$$$XXXX$$$$$$$$$$$$$XXXXXXXX$$+                                                                                                                                                                                               
                                                                                       .;+X$&&&&&&&&&&&$$X$$$$$$$XXXXXXx++++++;;+xXX$$$$$$XXXXXxxxx+x+++xxxxxxxxxxxxxxXxxXXXxx++;;;::;;;++XXX$$$$$$$$$$$$$$$$$x                                                                                                                                                                                                 
                                                                                               .+X$&&&&&&&&&$$$$$$$$$$XXx++++;;;;++XX$$&$$$$XXXXXXXXXXXXXXXXXXXXXXXXXXXXx;                      :+X$$$$$$$$$$;                                                                                                                                                                                                  
                                                                                                        :;+xXXX$$$&$$$$Xxx+;;;;;;;++xX$$&&&$X$$$$$$$$$$$$$$$$$Xx+:.                                  .;X$$$+                                                                                                                                                                                                    
                                                                                                                    .$$$XXx++++;;;;+xxXX$$&&$$$$$$$$$$$$$$X;                                                                                                                                                                                                                                                    
                                                                                                                      X&$XXXXxx++++++xxXXX$$$$$$$$$$$$$$x                                                                                                                                                                                                                                                       
                                                                                                                       +&$$XXXXxx+++++xXXX$$$$$$&$$$$&X                                                                                                                                                                                                                                                         
                                                                                                                        .$&$XXXXXXxx+++xXX$$&&&&&&&&&X                                                                                                                                                                                                                                                          
                                                                                                                          :$$$XXXXXXxxxxXXX$&&&$&&&&$.                                                                                                                                                                                                                                                          
                                                                                                                            ;$$$XXXXXXXXxXX$&&$$$&&$;                                                                                                                                                                                                                                                           
                                                                                                                              +$XXXXXXXXXXX&&&$$$&$+                                                                                                                                                                                                                                                            
                                                                                                                                +XXXXX$$XXX$$$$$$$X                                                                                                                                                                                                                                                             
                                                                                                                                  xXX$$XXXX$XXXX$$:                                                                                                                                                                                                                                                             
                                                                                                                                   :X$$XXXXXXXXX$x                                                                                                                                                                                                                                                              
                                                                                                                                    .$$XXX$XxxX$$                                                                                                                                                                                                                                                               
                                                                                                                                    :$$XXXXX++X$+                                                                                                                                                                                                                                                               
                                                                                                                                    ;$$XxXXX++XX:                                                                                                                                                                                                                                                               
                                                                                                                                    ;$$Xx+XXx+xx                                                                                                                                                                                                                                                                
                                                                                                                                    +$$X+xXXXxXx.                                                                                                                                                                                                                                                               
                                                                                                                                    +$$XxXXXXXXX;                                                                                                                                                                                                                                                               
                                                                                                                                    ;$XXXXXXXXXXX                                                                                                                                                                                                                                                               
                                                                                                                                     $$XXXXXXXXXXX.                                                                                                                                                                                                                                                             
                                                                                                                                     +$$$$$XXXXXXXX:                                                                                                                                                                                                                                                            
                                                                                                                                      X$$$$$XXXXXXXX+                                                                                                                                                                                                                                                           
                                                                                                                                      ;X$$$$XXXXXXXXXX:                                                                                                                                                                                                                                                         
                                                                                                                                      .X$$$$$XX$XXXXXXX+                                                                                                                                                                                                                                                        
                                                                                                                                      :X$$$$XXX$$XXXxXXX+                                                                                                                                                                                                                                                       
                                                                                                                                       X$$$$X$$$$$XXXXXXX:                                                                                                                                                                                                                                                      
                                                                                                                                       X$$$$$$$$$$XX$$$XX:                                                                                                                                                                                                                                                      
                                                                                                                                       +$$$$$$$$$$$$$$$X;                                                                                                                                                                                                                                                       
                                                                                                                                       :$$$$$&$&$$$$$$+                                                                                                                                                                                                                                                         
                                                                                                                                        X$$&&&&$$$$$x                                                                                                                                                                                                                                                           
                                                                                                                                        ;$$&&$$$$$+                                                                                                                                                                                                                                                             
                                                                                                                                         ;$$$$$x.                                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                
`.trimEnd();

/* ===== 2) Mouth (locked) ===== */
let MOUTH_ROW = 44;
let MOUTH_COL = 70;
let MOUTH_W   = 252;
let MOUTH_H   = 12;
let MOUTH_ROT_DEG = -16;

const LOCK_MOUTH = true;  // we won't move the mouth now
let showGuide = true;     // show crosshair/targets on by default for positioning

/* ===== 3) Tongue & Targets ===== */
let ANGLE_DEG = 0;          // 0 = use angle to target automatically
const TONGUE_THICK = 3;     // tongue thickness in rows

// Four locked shots + labels (edit after you record coords)
const SHOTS = [
  { row: 60, col: 120, label: "NOTHING" },
  { row: 60, col: 140, label: "TO"      },
  { row: 60, col: 160, label: "SEE"     },
  { row: 60, col: 180, label: "HERE"    },
];

// Whether to respect SHOTS (locked) or use the movable crosshair
let LOCK_TONGUE_TARGETS = false;

// Movable crosshair target for positioning
let cross = { row: 60, col: 120 };
const CROSS_CHAR = '✚';   // crosshair glyph

/* ===== 4) Timing ===== */
let FPS = 30;
const OPEN_STEPS   = 8;
const EXT_SPEED    = 10;
const RET_SPEED    = 10;
const MAX_LEN      = 1000;   // cap — but we stop at distance to target
const HOLD_FRAMES  = 60;     // longer hold so you can see the word

const SEG = '='; const TIP = '»';

/* ===== 5) DOM & lines ===== */
const baseEl = document.getElementById('base');
const ovEl   = document.getElementById('overlay');
const lines0 = ART.split('\n');

/* ===== Utilities ===== */
function originForShot(){
  return { row: MOUTH_ROW + Math.floor(MOUTH_H/2),
           col: MOUTH_COL + Math.floor(MOUTH_W/2) };
}
function targetAngle(target){
  const o = originForShot();
  return Math.atan2(target.row - o.row, target.col - o.col) * 180 / Math.PI;
}

/* ===== Mouth carving (rotated oval, opens top→bottom) ===== */
function carveMouth(srcLines, open01){
  const W = Math.max(1, MOUTH_W);
  const H = Math.max(1, Math.round(MOUTH_H * open01));

  const lines = srcLines.map(s => s.split(''));
  const cx = MOUTH_COL + Math.floor(W/2);
  const cy = MOUTH_ROW + Math.floor(MOUTH_H/2);

  const a = W/2;
  const b = Math.max(0.5, H/2);

  const th = (MOUTH_ROT_DEG*Math.PI)/180, cos=Math.cos(th), sin=Math.sin(th);

  for (let r=0;r<H;r++){
    const rr = MOUTH_ROW + r; if (rr<0 || rr>=lines.length) continue;
    for (let c=0;c<W;c++){
      const cc = MOUTH_COL + c; if (cc<0) continue;
      while (cc >= lines[rr].length) lines[rr].push(' ');
      const dx = cc - cx, dy = rr - cy;
      const xr =  dx*cos + dy*sin;
      const yr = -dx*sin + dy*cos;
      if ((xr*xr)/(a*a) + (yr*yr)/(b*b) <= 1) lines[rr][cc] = ' ';
    }
  }
  return lines.map(a=>a.join('')).join('\n');
}

/* ===== Tongue drawing (thick) ===== */
function drawTongue(len, row0, col0, angleDeg){
  if (len<=0) return '';
  const rad = angleDeg*Math.PI/180, dx=Math.cos(rad), dy=Math.sin(rad);
  const nx = -Math.sin(rad), ny = Math.cos(rad);
  const half = Math.floor((TONGUE_THICK-1)/2);

  const rows = new Map();
  const put = (r,c,ch)=>{
    r=Math.round(r); c=Math.max(0,Math.round(c));
    if (r<0) return; const a=rows.get(r)||[]; a.push([c,ch]); rows.set(r,a);
  };

  for (let i=0;i<Math.max(0,len-1);i++){
    for (let t=-half;t<=half;t++){
      put(row0 + dy*i + ny*t, col0 + dx*i + nx*t, SEG);
    }
  }
  for (let t=-half;t<=half;t++){
    put(row0 + dy*(len-1) + ny*t, col0 + dx*(len-1) + nx*t, TIP);
  }

  const maxR = Math.max(...rows.keys(), 0), out=[];
  for (let r=0;r<=maxR;r++){
    const a=rows.get(r); if(!a){out.push('');continue;}
    a.sort((x,y)=>x[0]-y[0]);
    let s='', last=-1;
    for (const [col,ch] of a){
      if (col>last+1) s+=' '.repeat(col-(last+1));
      s+=ch; last=col;
    }
    out[r]=s;
  }
  return '\n'.repeat(Math.max(0,row0)) + out.join('\n');
}

/* ===== Words layer at current shot ===== */
function drawWord(p){
  if (!p || !p.label) return '';
  const rows=new Map();
  const put=(r,c,s)=>{ r=Math.round(r); c=Math.max(0,Math.round(c));
    if (r<0) return; const a=rows.get(r)||[]; a.push([c,s]); rows.set(r,a);
  };
  const start = p.col - Math.floor(p.label.length/2);
  put(p.row, start, p.label);

  const maxR = Math.max(...rows.keys(),0), out=[];
  for (let r=0;r<=maxR;r++){
    const a=rows.get(r); if(!a){out.push('');continue;}
    a.sort((x,y)=>x[0]-y[0]);
    let s='', last=-1;
    for (const [col,text] of a){
      if (col>last+1) s+=' '.repeat(col-(last+1));
      s+=text; last = col + text.length - 1;
    }
    out[r]=s;
  }
  return '\n'.repeat(Math.max(0,p.row)) + out.join('\n');
}

/* ===== Guide (oval edge, 4 targets, crosshair) ===== */
function guideOverlay(currentShotIndex){
  const rows = new Map();
  const put=(r,c,ch)=>{ r=Math.round(r); c=Math.max(0,Math.round(c));
    if (r<0) return; const a=rows.get(r)||[]; a.push([c,ch]); rows.set(r,a);
  };

  // mouth outline
  const cx = MOUTH_COL + Math.floor(MOUTH_W/2);
  const cy = MOUTH_ROW + Math.floor(MOUTH_H/2);
  const a  = MOUTH_W/2, b = MOUTH_H/2;
  const th=(MOUTH_ROT_DEG*Math.PI)/180, cos=Math.cos(th), sin=Math.sin(th);
  for (let r=MOUTH_ROW;r<MOUTH_ROW+MOUTH_H;r++){
    for (let c=MOUTH_COL;c<MOUTH_COL+MOUTH_W;c++){
      const dx=c-cx, dy=r-cy;
      const xr= dx*cos + dy*sin, yr= -dx*sin + dy*cos;
      const v=(xr*xr)/(a*a) + (yr*yr)/(b*b);
      if (v>0.97 && v<1.03) put(r,c,'·');
    }
  }

  // locked shots markers
  SHOTS.forEach((p,i)=> put(p.row, p.col, i===currentShotIndex?'●':'•'));

  // crosshair
  put(cross.row, cross.col, CROSS_CHAR);

  const maxR=Math.max(...rows.keys(),0), out=[];
  for (let r=0;r<=maxR;r++){
    const a=rows.get(r); if(!a){out.push('');continue;}
    a.sort((x,y)=>x[0]-y[0]);
    let s='', last=-1;
    for (const [col,ch] of a){ if (col>last+1) s+=' '.repeat(col-(last+1)); s+=ch; last=col; }
    out[r]=s;
  }
  return '\n'.repeat(Math.max(0, Math.min(MOUTH_ROW, out.length?MOUTH_ROW:0))) + out.join('\n');
}

/* ===== Fit to viewport ===== */
function fit(){
  baseEl.style.transform = ovEl.style.transform = 'scale(1)';
  requestAnimationFrame(()=>{
    baseEl.textContent = carveMouth(lines0, open01);
    const pad=12, maxW=innerWidth-pad, maxH=innerHeight-pad;
    const w=baseEl.scrollWidth, h=baseEl.scrollHeight;
    const scale = Math.min(maxW/w, maxH/h, 1);
    const offX = Math.max((maxW - w*scale)/2, 0);
    const offY = Math.max((maxH - h*scale)/2, 0);
    const t = `translate(${offX}px, ${offY}px) scale(${scale})`;
    baseEl.style.transform=t; ovEl.style.transform=t;
  });
}
addEventListener('resize', fit);

/* ===== State ===== */
let phase='open', frame=0, open01=0, L=0, shotIdx=0;

/* ===== Main step ===== */
function currentTarget(){
  if (LOCK_TONGUE_TARGETS) return SHOTS[shotIdx] || SHOTS[SHOTS.length-1];
  return cross; // movable crosshair target
}
function step(){
  const o = originForShot();
  const t = currentTarget();
  const angle = ANGLE_DEG !== 0 ? ANGLE_DEG : targetAngle(t);

  switch(phase){
    case 'open':
      open01 = Math.min(1, (frame+1)/OPEN_STEPS);
      if (open01>=1){ phase='extend'; frame=-1; }
      break;
    case 'extend': {
      const dx=Math.abs(t.col - o.col), dy=Math.abs(t.row - o.row);
      const need = Math.min(MAX_LEN, Math.round(Math.hypot(dx,dy)));
      L = Math.min(need, L + EXT_SPEED);
      if (L>=need){ L=need; phase='hold'; frame=-1; }
      break;
    }
    case 'hold':
      if (frame>=HOLD_FRAMES){ phase='retract'; frame=-1; }
      break;
    case 'retract':
      L = Math.max(0, L - RET_SPEED);
      if (L<=0){
        if (LOCK_TONGUE_TARGETS){
          shotIdx++;
          if (shotIdx >= SHOTS.length){ phase='close'; } else { phase='extend'; }
        } else {
          phase='close';
        }
        frame=-1;
      }
      break;
    case 'close':
      open01 = Math.max(0, 1 - (frame+1)/OPEN_STEPS);
      if (open01<=0){
        phase='open'; frame=-1;
        if (LOCK_TONGUE_TARGETS) shotIdx = 0; // loop shots when locked
      }
      break;
  }
  frame++;

  // Base and overlay
  baseEl.textContent = carveMouth(lines0, open01);

  const tForWord = LOCK_TONGUE_TARGETS ? SHOTS[shotIdx] : null;
  const wordLayer = (phase==='hold' && tForWord) ? drawWord(tForWord) : '';

  ovEl.textContent =
    drawTongue(L, o.row, o.col, angle) +
    (showGuide ? guideOverlay(LOCK_TONGUE_TARGETS ? shotIdx : -1) : '') +
    wordLayer;
}

/* ===== Start / Pause ===== */
baseEl.textContent = ART;
let timer = setInterval(step, 1000/FPS);
document.addEventListener('visibilitychange', () => {
  if (document.hidden){ clearInterval(timer); timer=null; }
  else if (!timer){ timer=setInterval(step, 1000/FPS); }
});
function restart(){ clearInterval(timer); timer=setInterval(step, 1000/FPS); }

/* ===== Movement & hotkeys ===== */
function nudgeCross(dr, dc, fast=false){
  const step = fast ? 10 : 1;
  cross.row = Math.max(0, cross.row + dr*step);
  cross.col = Math.max(0, cross.col + dc*step);
}
function logTip(){
  // Log where the tip is right now (during extend/hold is most accurate)
  const o = originForShot();
  const t = currentTarget();
  const ang = ANGLE_DEG !== 0 ? ANGLE_DEG : targetAngle(t);
  const rad = ang*Math.PI/180;
  const tipRow = Math.round(o.row + Math.sin(rad) * Math.max(0, L - 1));
  const tipCol = Math.round(o.col + Math.cos(rad) * Math.max(0, L - 1));
  console.log(`TIP row: ${tipRow}, col: ${tipCol}`);
}

addEventListener('keydown',(e)=>{
  const k = e.key;
  if (k.toLowerCase()==='p'){ if (timer){clearInterval(timer); timer=null;} else restart(); }
  if (k==='+'||k==='='){ FPS=Math.min(120,FPS+5); restart(); }
  if (k==='-'||k==='_'){ FPS=Math.max(5,FPS-5);  restart(); }
  if (k.toLowerCase()==='g'){ showGuide=!showGuide; }

  // Toggle locked shots vs movable crosshair
  if (k.toLowerCase()==='t'){
    LOCK_TONGUE_TARGETS = !LOCK_TONGUE_TARGETS;
    console.log(`LOCK_TONGUE_TARGETS = ${LOCK_TONGUE_TARGETS}`);
    // reset phase to see immediate effect
    phase='open'; frame=0; L=0; shotIdx=0;
  }

  // Move crosshair (hold Shift for faster)
  const fast = e.shiftKey;
  if (!LOCK_TONGUE_TARGETS){
    if (k.toLowerCase()==='i') nudgeCross(-1, 0, fast);
    if (k.toLowerCase()==='k') nudgeCross( 1, 0, fast);
    if (k.toLowerCase()==='j') nudgeCross( 0,-1, fast);
    if (k.toLowerCase()==='l') nudgeCross( 0, 1, fast);
  }

  // Save crosshair into a shot slot
  if (!LOCK_TONGUE_TARGETS){
    if (k==='1'){ SHOTS[0].row=cross.row; SHOTS[0].col=cross.col; console.log('Saved NOTHING to', SHOTS[0]); }
    if (k==='2'){ SHOTS[1].row=cross.row; SHOTS[1].col=cross.col; console.log('Saved TO to', SHOTS[1]); }
    if (k==='3'){ SHOTS[2].row=cross.row; SHOTS[2].col=cross.col; console.log('Saved SEE to', SHOTS[2]); }
    if (k==='4'){ SHOTS[3].row=cross.row; SHOTS[3].col=cross.col; console.log('Saved HERE to', SHOTS[3]); }
  }

  // Log the current tongue tip coordinates
  if (k.toLowerCase()==='k') logTip();
});

/* ===== Kick off & fit ===== */
fit();
</script>
